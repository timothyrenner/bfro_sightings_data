version: 2

sources:
  - name: local_files
    description: >
      Local file sources, extracted from the site, KML file, and weather API.
    meta:
      # TODO: extract this to an env var.
      external_location: "~/bfro_sightings_data/data_new/sources/{name}.csv"
    tables:
      - name: bfro_reports
        description: Full text reports extracted from the BFRO site via scrapy.
        columns:
          - name: year
            description: The year the sighting took place. Sometimes approximate.
          - name: season
            description: The season the sighting took place.
            tests:
              - accepted_values:
                  values: ['Fall', 'Winter', 'Spring', 'Summer', 'Unknown']
              - not_null
          - name: month
            description: The month the sighting occurred.
          - name: date
            description: >
              The date the sighting occurred, as pretty much any format you
              can think of. Highly non-uniform.
          - name: state
            description: The name of the state in which the sighting occurred.
            tests:
              - not_null
          - name: county
            description: The county in which the sighting occurred.
            tests:
              - not_null
          - name: location_details
            description: Additional details about the location of the sighting.
          - name: observed
            description: The sighting description itself.
          - name: also_noticed
            description: Additional details pertinent to the sighting.
          - name: other_witnesses
            description: Witnesses to the sighting besides the original reporter.
          - name: other_stories
            description: Other stories related to the sighting at that location.
          - name: time_and_conditions
            description: >
              The time of day and natural language weather conditions for the
              sighting.
          - name: environment
            description: >
              A natural language description of the environment and surrounding
              area where the sighting occurred.
          - name: report_number
            description: >
              The primary key identifier for each report.
            tests:
              - not_null
              - unique
          - name: report_class
            description: >
              The report classification. Either "Class A" - direct sighting,
              "Class B" - indirect evidence (footprints, scat, etc), or 
              "Class C" - rumors and stories.
            tests:
              - not_null
              - accepted_values:
                  values: ['Class A', 'Class B', 'Class C']
          - name: a_&_g_references
            description: >
              References to what look like external media, newspapers, etc.
              Null for most of the reports.
          - name: pulled_datetime
            description: The datetime the record was scraped.
            tests:
              - not_null
      - name: weather_cache
      - name: geocoded_reports 